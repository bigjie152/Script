# Script AI Platform 全链路里程碑管理

> 说明：本文件用于里程碑规划与状态跟踪，不执行具体改动。

## 当前事实基线（已稳定）
- 生产环境同域 API 已稳定闭环（POST projects / GET project / PUT truth / GET issues）。
- Workspace → Editor 已能跑通最小编辑闭环。
- “返回 Workspace”按钮已解决。

## 里程碑总览
| 里程碑 | 目标摘要 | 进入条件（Gate） | 当前状态 |
| --- | --- | --- | --- |
| M0 | 稳定基线固化 | 回归脚本 20 次 100% 成功；5 分钟内验证基线 | 已完成 |
| M1 | 编辑器状态机与面板结构对齐 | 锁定/解锁一致；派生区/逻辑审查独立 | 进行中（待线上解锁验收） |
| M2 | 角色/线索/时间线/DM/概览可编辑闭环 | 4 个模块闭环稳定 | 待执行 |
| M3 | TipTap 接入准备（适配层） | Adapter 稳定 + DocumentEditor 复用 | 待执行 |
| M4 | TipTap 首次接入（仅 Truth） | 保存 50 次无损坏 | 待执行 |
| M5 | AI 工作流外壳（Mock） | 全流程 mock 可跑通 | 待执行 |
| M6 | 真实模型接入（仅生成真相） | 成功率 >95% | 待执行 |
| M7 | 真实模型接入（生成角色） | 可重复生成不崩溃 | 待执行 |
| M8 | 真实逻辑审查 | issues 结构稳定 | 待执行 |
| M9 | 内测准备 | 账号 + 可观测 + SOP | 待执行 |

## Milestone 0 — 稳定基线固化
**目标**：把最小闭环固化成不可回退的基线。  
**交付**：
- verify-online.ps1 / verify-online.sh（create/get/put truth/get issues）
- online-acceptance-report.md（记录生产域名、请求样例、预期响应）
- 响应 requestId（header/body 任一即可）+ 结构化日志（requestId/route/status/latencyMs/error）
**Gate 0**：回归脚本 20 次 100% 成功；任意部署 5 分钟内验证基线。  
**验收方式**：脚本回归 + 报告记录。  
**产出物**：脚本 + 报告 + 最小日志规范。

## Milestone 1 — 编辑器状态机与面板结构对齐
**目标**：Draft → Locked → 解锁可逆；派生与逻辑审查结构正确。  
**交付**：
- Truth 状态机可逆（UI + API）
- 派生生成与逻辑审查分区
- 模块路由稳定、空态/错误态/保存态齐备
**Gate 1**：锁定/解锁与后端一致；派生区门控；逻辑审查独立。  
**验收方式**：/editor/[module] 路由 + UI 操作回归。  
**产出物**：页面/组件更新 + 验收记录。

**当前进展**：
- UI 已接入锁定/解锁与派生/逻辑审查分区
- 线上 `POST /api/projects/:id/truth/unlock` 仍 404，等待最新部署生效后复验

## Milestone 2 — 角色/线索/时间线/DM/概览可编辑闭环
**目标**：每个模块可编辑/可保存/可回读（不接 TipTap/AI）。  
**顺序**：角色 → 线索 → 时间线 → DM → 概览。  
**Gate 2**：4 个模块闭环稳定，issues 仍稳定。  
**验收方式**：逐模块编辑/保存/刷新一致性回归。  
**产出物**：模块页面与 API 封装完善。

## Milestone 3 — TipTap 接入准备（适配层）
**目标**：结构准备可替换编辑引擎。  
**交付**：
- EditorDocument/适配层
- DocumentEditor 接口统一
- 模块配置化
**Gate 3**：Adapter 稳定 + DocumentEditor 至少被 2 个模块复用。  
**验收方式**：模块复用与接口稳定性检查。  
**产出物**：adapter + modules config + 文档说明。

## Milestone 4 — TipTap 首次接入（仅 Truth）
**目标**：Truth 替换为 TipTap，确保数据兼容。  
**Gate 4**：保存 50 次无损坏、跨刷新一致、输入性能可接受。  
**验收方式**：重复保存与回读一致性回归。  
**产出物**：Truth 编辑器实现 + 兼容策略记录。

## Milestone 5 — AI 工作流外壳（Mock）
**目标**：Mock 工作流完整跑通。  
**Gate 5**：Mock 全流程可跑通，具备运行态与可重试。  
**验收方式**：按钮状态与流程闭环演练。  
**产出物**：mock provider + UI 状态机。

## Milestone 6 — 真实模型接入（仅生成真相）
**目标**：仅接入生成真相，控制影响面。  
**Gate 6**：成功率 >95%，不破坏锁定流程。  
**验收方式**：连续 20 次回归 + TipTap 回读一致。  
**产出物**：provider 抽象 + 日志与回放 + 调试入口。

## Milestone 7 — 真实模型接入（生成角色）
**目标**：角色生成可重复、可编辑。  
**Gate 7**：可重复生成 10 次不崩溃；覆盖/追加策略明确。  
**验收方式**：角色多次生成回归。  
**产出物**：角色生成与覆盖策略文档。

## Milestone 8 — 真实逻辑审查
**目标**：issues 结构稳定并可定位。  
**Gate 8**：矛盾样例可稳定产出 issues；无问题返回空列表。  
**验收方式**：样例库回归。  
**产出物**：issues 结构说明与定位策略。

## Milestone 9 — 内测准备
**目标**：小规模内测可控可回滚。  
**Gate 9**：Truth + 角色稳定；错误可定位；数据可迁移/兼容。  
**验收方式**：内测 SOP 与演练。  
**产出物**：账号系统 + 可观测 + 内测流程。
